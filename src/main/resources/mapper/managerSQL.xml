<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="manager">
	<select id="MemberList" resultType="member" parameterType="map">
		select * from
		(select rownum as rnum, mem.* from
		(select
			member_no as memberNo,
			member_id as memberId,
			member_nick as memberNick,
			member_phone as memberPhone,
			member_point as memberPoint,
			member_reportcount as memberReportCount,
			enrolldate as enrollDate
		from member_tbl 
		<choose>
			<when test="selMem == 0">
				where grade=1 or grade=2 or grade=3
			</when>
			<when test="selMem == 1">
				where grade=1
			</when>
			<when test="selMem == 2">
				where grade=2
			</when>
			<when test="selMem == 3">
				where grade=3
			</when>
			<otherwise>
				where grade=4
			</otherwise>
		</choose>
		order by member_no desc) mem)
		where rnum between #{start} and #{end}
	</select>
	<select id="memberCount" resultType="int" parameterType="int">
		select count(*) from member_tbl
		<choose>
			<when test="value == 0">
				where grade=1 or grade=2 or grade=3
			</when>
			<when test="value == 1">
				where grade=1
			</when>
			<when test="value == 2">
				where grade=2
			</when>
			<when test="value == 3">
				where grade=3
			</when>
			<otherwise>
				where grade=4
			</otherwise>
		</choose>
	</select>

	<update id="updateBlackList" parameterType="map">
		update member_tbl set
		<choose>
			<when test="updateNo == 0">
				grade=4
			</when>
			<otherwise>
				grade=2
			</otherwise>
		</choose>
		where member_no=#{memberNo}
	</update>
	
</mapper>
