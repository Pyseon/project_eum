<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="member">
	
	<!-- 대권 로그인 -->
	<select id="selectOneMember" parameterType="member" resultType="member">
 		select
 			member_no as memberNo,
 			member_id as memberId,
 			member_pw as memberPw,
 			member_nick as memberNick,
 			member_phone as memberPhone,
 			member_point as memberPoint,
 			member_reportcount as memberReportCount,
 			gender,
 			birth,
 			agreement,
 			grade,
 			member_picturename as memberPictureName,
 			member_picturepath as memberPicturePath,
 			enrollDate
 		from member_tbl where member_id=#{memberId}
 		<if test="memberPw != null">
 			and member_Pw=#{memberPw}
 		</if>
 	</select>
	<!-- 재민 -->
	<update id="updateMember" parameterType="m" >
	update into member_tbl set 
		member_id =#{memberId}, 
		member_nick =#{memberNick}, 
		member_pw=#{memberPw}, 
		member_Phone = #{memberPhone}, 
		gender = #{gender}, 
		birth = #{gender}  where member_no=#{memberNo}
	
	</update>
		<!-- 재민 내 구매목록삭제 -->
	  <update id ="DeleteMyproduct" parameterType="int">
	 		 update into payment_tbl set
	 		 pay_state = 3
	 		 
			where member_no=#{payNo}
			

	  </update>
	 <select id ="selectQuestionList" parameterType="map" resultType="q">
 		select
 		qst_no as qstNo,
 		qst_title as qstTitle,
 		qst_date as qstDate
 		
 		
 		from question_tbl
  
  	</select>
  		<!-- 재민 내 구매목록 -->
	  <select id ="selectProductList" resultType="productAndPay">
	 		select 
	 			product_tbl.product_no as productNo,
	 			product_title as productTitle,
	 			pay_date as payDate, 
	 			payment, 
	 			pay_state as paystate,
	 			pay_No as payNo,
	 			member_No as memberNo
			from product_tbl
			join payment_tbl on (payment_tbl.product_no = product_tbl.product_no)
			where member_no=#{memberNo}
			

	  </select>
	  <select id ="Myproductdetail" resultType="pay">
	 		select 
	 			pay_no as payNo,
	 			product_no as productNo,
	 			pay_date as payDate,
	 			payment,
	 			pay_usepoint as payUsepoint,
	 			pay_addpoint as payAddpoint
	 			
			from payment_tbl
			
			where pay_no=#{payNo} 
			

	  </select>
	   <select id ="selectWishlist" resultType="productAndPayAndwish">
	 		select 
				product_tbl.product_title as productTitle, 
				payment_tbl.payment as payment
			from product_tbl
			join payment_tbl on (payment_tbl.product_no = product_tbl.product_no)
			join wishlist_tbl on (wishlist_tbl.product_no = product_tbl.product_no)
			where wishlist_tbl.member_no=#{memberNo}
	  </select>
	  

	<!-- 윤지 -->
	<select id="selectOneExpert" parameterType="int" resultType="expertAndCom">
 		SELECT 
 			COMP_NO as compNo,
			A.EXPERT_NO as expertNo,
			COMP_CATEGORY as compCategory,
			COMP_REP_NAME as compRepName,
			COMP_NAME as compName,
			COMP_REGNO as compRegno,
			COMP_ADDR as compAddr,
			COMP_PHONE as compPhone,
			COMP_EMAIL as compEmail,
			MEMBER_NO as memberNo,
			EXPERT_CATEGORY as expertCategory,
			EXPERT_TAG as expertTag,
			CREDENTIAL,
			ISSUING_AUTHORITY as issuingAuthority,
			ACQUISTION_DATE as acquistionDate,
			EXPERT_NAME as expertName,
			EXPERT_PHONE as expertPhone,
			EXPERT_EMAIL as expertEmail,
			EXPERT_CONTENT as expertContent,
			JOB_NAME as jobName,
			EXPERT_PR as expertPr,
			EXPERT_CAREER as expertCareer,
			EXPERT_INTRO as expertIntro
		FROM 
			expert_tbl A
		JOIN 
			company_tbl B on (A.expert_no = B.expert_no)
		where 
			A.expert_no=#{expertNo}
 	</select>
 	
	<!-- 윤지 -->
	<select id="selectOneExpertPicture" parameterType="int" resultType="expertAndM">
 		select 
 			expert_no, member_no,
			(select member_picturepath from member_tbl where expert_tbl.member_no = member_tbl.member_no) as memberPicturepath 
		from 
			expert_tbl
		where 
			expert_no=#{exportNo}
 	</select>
	
	<!-- 윤지 -->
	<select id="selectOneExpertOnly" parameterType="int" resultType="expert">
 		SELECT 
 			EXPERT_NO as expertNo,
			MEMBER_NO as memberNo,
			EXPERT_CATEGORY as expertCategory,
			EXPERT_TAG as expertTag,
			CREDENTIAL,
			ISSUING_AUTHORITY as issuingAuthority,
			ACQUISTION_DATE as acquistionDate,
			EXPERT_NAME as expertName,
			EXPERT_PHONE as expertPhone,
			EXPERT_EMAIL as expertEmail,
			EXPERT_CONTENT as expertContent,
			JOB_NAME as jobName,
			EXPERT_PR as expertPr,
			EXPERT_CAREER as expertCareer,
			EXPERT_INTRO as expertIntro
		FROM 
			expert_tbl 
		where 
			expert_no=#{expertNo}
 	</select>
 	
 	<!-- 윤지 -->
 	<select id="selectOneExpert2" parameterType="int" resultType="expertAndCom">
 		SELECT 
            COMP_NO as compNo,
			E.EXPERT_NO as expertNo,
			COMP_REP_NAME as compRepName,
			COMP_NAME as compName,
			COMP_REGNO as compRegno,
			E.MEMBER_NO as memberNo,
			CREDENTIAL,
			EXPERT_NAME as expertName,
			EXPERT_PHONE as expertPhone,
			EXPERT_EMAIL as expertEmail,
			EXPERT_CONTENT as expertContent,
			JOB_NAME as jobName,
			EXPERT_PR as expertPr,
			EXPERT_CAREER as expertCareer,
			EXPERT_INTRO as expertIntro
        FROM PAYMENT_TBL PAY
        JOIN PRODUCT_TBL PRO
        ON PAY.PRODUCT_NO = PRO.PRODUCT_NO
        JOIN EXPERT_TBL E
        ON PRO.EXPERT_NO = E.EXPERT_NO
        JOIN COMPANY_TBL C
        ON E.EXPERT_NO = C.EXPERT_NO
        WHERE PAY.PAY_NO=#{payNo}
 	</select>
 	
 	<!-- 윤지 -->
 	<select id="selectOneExpertOnly2" parameterType="int" resultType="expert">
 		SELECT 
 			E.EXPERT_NO as expertNo,
			E.MEMBER_NO as memberNo,
			EXPERT_CATEGORY as expertCategory,
			EXPERT_TAG as expertTag,
			CREDENTIAL,
			ISSUING_AUTHORITY as issuingAuthority,
			ACQUISTION_DATE as acquistionDate,
			EXPERT_NAME as expertName,
			EXPERT_PHONE as expertPhone,
			EXPERT_EMAIL as expertEmail,
			EXPERT_CONTENT as expertContent,
			JOB_NAME as jobName,
			EXPERT_PR as expertPr,
			EXPERT_CAREER as expertCareer,
			EXPERT_INTRO as expertIntro
		FROM 
			EXPERT_TBL E
		JOIN PRODUCT_TBL PRO
        ON PRO.EXPERT_NO = E.EXPERT_NO
        JOIN PAYMENT_TBL PAY
        ON PRO.PRODUCT_NO = PAY.PRODUCT_NO
        WHERE PAY.PAY_NO=#{payNo}
 	</select>
 	
 	<!-- 윤지 -->
 	<select id="selectOneExpertPicture2" parameterType="int" resultType="expertAndM">
 		select 
 			e.expert_no as expertNo, 
 			m.member_no as memberNo,
 			member_picturepath as memberPicturepath
		from expert_tbl e
        join member_tbl m
        on e.member_no = m.member_no
        join product_tbl pro
        on e.expert_no = pro.expert_no
        join payment_tbl pay
        on pro.product_no = pay.product_no
		where 
			pay.pay_no=#{payNo}
 	</select>
</mapper>
